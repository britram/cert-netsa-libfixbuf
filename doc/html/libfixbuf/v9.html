
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>fixbuf- Documentation</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <link rel="stylesheet" type="text/css" href="../../site/style.css" />
        <link rel="stylesheet" type="text/css" href="doxygen.css">
        <link rel="stylesheet" type="text/css" href="tabs.css">
</head>
<body>
    <div id="p-body">
      <div id="l-header">
        <img src="../../site/sei-logo.png" id="l-sei-logo"
            alt="Software Engineering Institute | Carnegie Mellon&copy;" />
        <div id="l-netsa-logo"><a id="l-netsa-name" href="../../index.html"><b>CERT NetSA Security Suite</b></a></div>
        <div id="l-netsa-motto">Monitoring for Large-Scale Networks</div>
        <h1 class="l-page-title">fixbuf</h1>
        <span id="l-subtitle">Documentation</span>
      </div><!-- l-header -->
      <div id="l-content">
        <div id="l-sidebar">
          <div class="p-sidebar-section">
            <h1><a href="../index.html">fixbuf</a></h1>
            <ul>
              <li><a href="index.html">Documentation</a></li>
              <li><a href="../download.html">Downloads</a></li>
	      <li><a href="../../pyfixbuf/index.html">pyfixbuf</a></li>
            </ul>
          </div><!-- p-sidebar-section -->
        </div><!-- l-sidebar -->
      <div id="top"> <!-- need this for doxygen -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">NetFlow v9 Collectors </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>How-To use libfixbuf as a NetFlow v9 Collector:</p>
<p>libfixbuf can be used as a <a href="https://tools.ietf.org/html/rfc3954">NetFlow v9</a> collector and convert NetFlow to IPFIX. Follow the <a class="el" href="udp.html">steps above</a> to create an fbListener. After creating the listener, retrieve the collector by calling <a class="el" href="public_8h.html#a7e64858b1a8766f7e2889b1de70fca97" title="If a collector is associated with the listener class, this will return a handle to the collector stat...">fbListenerGetCollector()</a> before calling <a class="el" href="public_8h.html#aa751f591a9ae4cd4a46c57f11798a592" title="Sets the collector input translator to convert NetFlowV9 into IPFIX for the given collector...">fbCollectorSetNetflowV9Translator()</a>. Fixbuf can decode all NetFlow v9 information elements up to 346. Since fixbuf removes the SysUpTime from the NetFlow v9 Header, when fixbuf encounters elements 21 and 22 (which rely on the SysUpTime to determine flow start and end times) it will add IPFIX Element 160 (systemInitTimeMilliseconds) to the template and corresponding flow record. systemInitTimeMilliseconds is the Packet Export Time (found in the NetFlow v9 Header) converted to milliseconds minus the SysUpTime. Also, for arbitrary Cisco Elements (ID &gt; 346), fixbuf will convert the element ID to 9999 in order to decode the element properly. The exceptions are elements 33002 (NF_F_FW_EXT_EVENT) and 40005 (NF_F_FW_EVENT) which are often exported from Cisco's ASA device. These elements will be converted to their corresponding element id's in libfixbuf's default Information Model, 9997 and 9998 respectively. Similarly, the Cisco ASA will also export elements 40001, 40002, 40003, and 40004. These elements are substituted with the IPFIX elements 225, 226, 227, and 228 respectively.</p>
<p>libfixbuf will also convert NetFlow v9 Options Templates and Options Records to IPFIX. Due to the differences between IPFIX and NetFlow v9 Options Templates the NetFlow v9 Scope Field Type is dropped and replaced with the Information Element ID 263, messageScope. The Scope Field Length will be carried over to the IPFIX Options Template, and the messageScope will have the length specified by Scope Field Length. This holds true for all Scope Elements defined in the NetFlow v9 Options Template. In order to retrieve the value for the Scope Field Type, the IPFIX internal template should use the messageScope Information Element and use the length override (the default length for messageScope is 1).</p>
<p>libfixbuf differentiates NetFlow v9 streams by IP and observation domain. If no activity is seen from a NetFlow v9 exporter within 30 minutes, the session and all the templates associated with it will be freed. It is best to set the template timeout period on the device to under 30 minutes.</p>
<p><a class="el" href="public_8h.html#a09cc8db0d961b61a5087c5b107b8c1eb" title="Returns the number of potential missed export packets of the Netflow v9 session that is currently set...">fbCollectorGetNetflowMissed()</a> can be used to retrieve the number of potential missed export packets. This is not the number of FLOW records that the collector has missed. NetFlow v9 increases sequence numbers by the number of export packets it has sent, NOT the number of flow records. An export packet may not contain any flow records. Fixbuf tries to account for any reboot of the device and not count large sequence number discrepancies in it's missed count.</p>
<p>To disable NetFlow v9 log messages such as sequence number mismatch messages, option template removal messages, and record count discrepancy messages, run <code>make clean</code>, <code>CFLAGS="-DFB_SUPPRESS_LOGS=1" make -e</code>, <code>make install</code> when installing libfixbuf. </p>
</div></div><!-- contents -->
      </div><!-- l-content -->
      <div id="l-footer">&copy; 2006-2018 Carnegie Mellon University</div>
    </div><!-- p-body -->
</body>
</html>
