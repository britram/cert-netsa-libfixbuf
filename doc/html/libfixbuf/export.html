
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>fixbuf- Documentation</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <link rel="stylesheet" type="text/css" href="../../site/style.css" />
        <link rel="stylesheet" type="text/css" href="doxygen.css">
        <link rel="stylesheet" type="text/css" href="tabs.css">
</head>
<body>
    <div id="p-body">
      <div id="l-header">
        <img src="../../site/sei-logo.png" id="l-sei-logo"
            alt="Software Engineering Institute | Carnegie Mellon&copy;" />
        <div id="l-netsa-logo"><a id="l-netsa-name" href="../../index.html"><b>CERT NetSA Security Suite</b></a></div>
        <div id="l-netsa-motto">Monitoring for Large-Scale Networks</div>
        <h1 class="l-page-title">fixbuf</h1>
        <span id="l-subtitle">Documentation</span>
      </div><!-- l-header -->
      <div id="l-content">
        <div id="l-sidebar">
          <div class="p-sidebar-section">
            <h1><a href="../index.html">fixbuf</a></h1>
            <ul>
              <li><a href="index.html">Documentation</a></li>
              <li><a href="../download.html">Downloads</a></li>
	      <li><a href="../../pyfixbuf/index.html">pyfixbuf</a></li>
            </ul>
          </div><!-- p-sidebar-section -->
        </div><!-- l-sidebar -->
      <div id="top"> <!-- need this for doxygen -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Exporter Usage </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>How-To Export IPFIX: Each fixbuf application must have a single fbInfoModel_t instance that represents the Information Elements that the application understands.</p>
<p>The <a class="el" href="public_8h.html#a390f707c7decf65060f31c0dba6c2a97" title="Allocate a new information model. ">fbInfoModelAlloc()</a> call allocates a new Information Model with the IANA-managed information elements (current as of the fixbuf release date) preloaded. Additional vendor-specific information elements may be added with <a class="el" href="public_8h.html#ae06a524366afa6827d7e5abb1c33c0d0" title="Add a single information element to an information model. ">fbInfoModelAddElement()</a>, <a class="el" href="public_8h.html#a202bfa2340263229893a38de18670179" title="Add multiple information elements in an array to an information model. ">fbInfoModelAddElementArray()</a>, <a class="el" href="public_8h.html#aad00d1ffb4ef338bba8ac31e0c109f51" title="Add information specified in the given XML file to the information model. ">fbInfoModelReadXMLFile()</a>, and <a class="el" href="public_8h.html#a3d3efcc1c075736f9c0c0425cf0aa8c2" title="Add information specified in the given XML data to the information model. ">fbInfoModelReadXMLData()</a>.</p>
<p>To create an Exporter, first create an fbSession_t attached to the application's fbInfoModel_t to hold the Exporter's Transport Session state using <a class="el" href="public_8h.html#ace1d8a4523d098e625d5330e0d15bd4b" title="Allocate a transport session state container. ">fbSessionAlloc()</a>. If exporting via the Spread protocol, create an fbSpreadParams_t and set its session to your newly defined session, group names (a null terminated array), and Spread daemon name.</p>
<p>Then create an fbExporter_t to encapsulate the connection to the Collecting Process or the file on disk, using the <a class="el" href="public_8h.html#a4055c4e29d7358629373e2be2a89a4dd" title="Allocate an exporting process endpoint for an opened ANSI C file pointer. ">fbExporterAllocFP()</a>, <a class="el" href="public_8h.html#a8b159cd95821b4382a04543f18faa279" title="Allocate an exporting process endpoint for a named file. ">fbExporterAllocFile()</a>, <a class="el" href="public_8h.html#a56ccd30ae0534e838107d39769b8f9f9" title="Allocate an exporting process endpoint for a network connection. ">fbExporterAllocNet()</a>, <a class="el" href="public_8h.html#a6cf2759b8c7997a09af6c5b78af43861" title="Allocate an exporting process for a buffer. ">fbExporterAllocBuffer()</a>, or <a class="el" href="public_8h.html#a4c78a85f509340af59fb05a8fb0890c8" title="Allocate an exporting process endpoint for a Spread connection. ">fbExporterAllocSpread()</a> calls.</p>
<p>With an fbSession_t and an fbExporter_t available, create a buffer for writing via <a class="el" href="public_8h.html#a2fb7c1a2229e3e8c15c04a215c92329b" title="Allocate a new buffer for export. ">fBufAllocForExport()</a>.</p>
<p>Create and populate templates for addition to this session using the fbTemplate calls, then add them to the session via <a class="el" href="public_8h.html#a2e4baf6d2142eca4cb526b1e80628bf8" title="Add a template to a session. ">fbSessionAddTemplate()</a>.</p>
<p>If exporting via Spread, before calling <a class="el" href="public_8h.html#a2e4baf6d2142eca4cb526b1e80628bf8" title="Add a template to a session. ">fbSessionAddTemplate()</a>, set the group that should receive this template with the <a class="el" href="public_8h.html#a3c93bca4f6e239e7712fafaa8f1beefb" title="This function checks to see if the groups you are setting on the buffer are different than the groups...">fBufSetSpreadExportGroup()</a> call. If more than 1 group should receive the template, use the <a class="el" href="public_8h.html#a183ad2821b346332f83e3e0dc72ba284" title="Set and send templates for 1 or more groups. ">fbSessionAddTemplatesMulticast()</a> which will call <a class="el" href="public_8h.html#a3c93bca4f6e239e7712fafaa8f1beefb" title="This function checks to see if the groups you are setting on the buffer are different than the groups...">fBufSetSpreadExportGroup()</a> on the given group(s) multicast the template to the given group(s). For Spread, do not use <a class="el" href="public_8h.html#a2e4baf6d2142eca4cb526b1e80628bf8" title="Add a template to a session. ">fbSessionAddTemplate()</a> to send to multiple groups.</p>
<p>Once the templates have been added to the session, use <a class="el" href="public_8h.html#a4e0c42fc80985c048190203257697ab6" title="Export all external templates in the current domain of a given session. ">fbSessionExportTemplates()</a> to add the templates to the buffer and then set the internal and external template IDs with <a class="el" href="public_8h.html#a28c6c56234351a793fd513b212bd31b8" title="Set the internal template on a buffer to the given template ID. ">fBufSetInternalTemplate()</a> and <a class="el" href="public_8h.html#af6cd20b1eb9a3287f17587888ee2476b" title="Set the external template for export on a buffer to the given template ID. ">fBufSetExportTemplate()</a>. You can then use <a class="el" href="public_8h.html#ad3fdaa8626ff753c5b617707698c22b6" title="Append a record to a buffer. ">fBufAppend()</a> to write records into IPFIX Messages and Messages to the output stream.</p>
<p>Note that Templates use internal reference counting, so they may be added to multiple sessions, or to the same session using multiple template IDs or multiple domains, or as both an internal and an external template on the same session.</p>
<p>By default, <a class="el" href="public_8h.html#ad3fdaa8626ff753c5b617707698c22b6" title="Append a record to a buffer. ">fBufAppend()</a> will emit an IPFIX Message to the output stream when the end of the message buffer is reached on write. The <a class="el" href="public_8h.html#a661f4cc21e726345d3e22372af33c2d1" title="Set the automatic mode flag on a buffer. ">fBufSetAutomaticMode()</a> call can be used to modify this behavior, causing <a class="el" href="public_8h.html#ad3fdaa8626ff753c5b617707698c22b6" title="Append a record to a buffer. ">fBufAppend()</a> to return FB_ERROR_EOM when at end of message. Use this if your application requires manual control of message export. In this case, <a class="el" href="public_8h.html#a3def007c235fd0dccb7a2293b23341e1" title="Emit the message currently in a buffer using the associated exporting process endpoint. ">fBufEmit()</a> will emit a Message to the output stream. If using Spread, call <a class="el" href="public_8h.html#a3c93bca4f6e239e7712fafaa8f1beefb" title="This function checks to see if the groups you are setting on the buffer are different than the groups...">fBufSetSpreadExportGroup()</a> to set the groups to export to on the buffer before calling <a class="el" href="public_8h.html#ad3fdaa8626ff753c5b617707698c22b6" title="Append a record to a buffer. ">fBufAppend()</a>. </p>
</div></div><!-- contents -->
      </div><!-- l-content -->
      <div id="l-footer">&copy; 2006-2018 Carnegie Mellon University</div>
    </div><!-- p-body -->
</body>
</html>
